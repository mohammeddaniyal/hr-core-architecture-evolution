/* --- 1. The Trigger Button --- */
#xray-trigger {
    position: fixed; bottom: 20px; right: 20px;
    background-color: #0f172a; color: #38bdf8;
    border: 1px solid #38bdf8; padding: 10px 15px;
    border-radius: 8px; font-family: monospace;
    cursor: pointer; z-index: 9999;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3); transition: all 0.2s;
}
#xray-trigger:hover { background-color: #38bdf8; color: #0f172a; }

/* --- 2. The Drawer Shell --- */
#xray-drawer {
    position: fixed; top: 0; right: -450px;
    width: 420px; height: 100vh;
    background-color: #0f172a; color: #e2e8f0;
    font-family: 'Courier New', Courier, monospace;
    box-shadow: -5px 0 15px rgba(0,0,0,0.5);
    transition: right 0.4s ease-in-out; z-index: 10000;
    padding: 20px; box-sizing: border-box;
    display: flex; flex-direction: column;
}
#xray-drawer.open { right: 0; }

/* --- 3. Header (Always Visible) --- */
.xray-header { border-bottom: 1px solid #334155; padding-bottom: 10px; margin-bottom: 15px; }
.xray-header h2 { margin: 0 0 5px 0; font-size: 1.2rem; color: #38bdf8; }
.xray-header h3 { margin: 0; font-size: 0.9rem; color: #94a3b8; font-weight: normal; }

#xray-menu-view { display: flex; flex-direction: column; flex-grow: 1; overflow-y: auto; }
#xray-sim-view { 
    display: none; flex-direction: column; flex-grow: 1; 
    overflow: hidden; /* FIX 1: Traps the console so it cannot stretch the screen */
}
/* --- 5. Menu Elements --- */
#xray-impact {
    background: rgba(16, 185, 129, 0.05); border-left: 4px solid #10b981;
    padding: 15px; margin-bottom: 25px; border-radius: 0 4px 4px 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
#xray-impact h4 { margin: 0 0 10px 0; color: #10b981; font-size: 0.9rem; text-transform: uppercase; }
#xray-impact ul { margin: 0; padding-left: 20px; font-size: 0.85rem; color: #cbd5e1; line-height: 1.5; }
#xray-impact li { margin-bottom: 8px; }

.xray-controls { display: flex; flex-direction: column; gap: 10px; }
.xray-btn { padding: 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 1rem; }
.btn-success { background: #10b981; color: white; }
.btn-success:hover { background: #059669; }
.btn-error { background: #ef4444; color: white; }
.btn-error:hover { background: #dc2626; }
.xray-close { background: transparent; color: #94a3b8; border: 1px solid #94a3b8; margin-top: 10px; }

/* --- 6. Simulation Elements --- */
.xray-network {
    position: relative; display: flex; justify-content: space-between;
    align-items: center; padding: 15px 0; margin-bottom: 20px; flex-shrink: 0;
}
.xray-network::before {
    content: ''; position: absolute; top: 50%; left: 10%; right: 10%;
    height: 2px; background-color: #334155; z-index: 1;
}
.xray-node {
    background: #1e293b; border: 2px solid #475569; padding: 10px;
    border-radius: 8px; z-index: 2; text-align: center; font-size: 0.8rem; width: 60px;
}
#xray-dot {
    position: absolute; top: 50%; transform: translate(-50%, -50%);
    width: 12px; height: 12px; border-radius: 50%; z-index: 3; opacity: 0;
    transition: left 1s ease-in-out, background-color 0.3s, box-shadow 0.3s;
}
.pos-client { left: 10%; } .pos-server { left: 50%; } .pos-database { left: 90%; }
.type-request { background: #3b82f6; box-shadow: 0 0 10px #3b82f6; opacity: 1 !important;}
.type-process { background: #eab308; box-shadow: 0 0 10px #eab308; opacity: 1 !important;}
.type-response { background: #10b981; box-shadow: 0 0 10px #10b981; opacity: 1 !important;}
.type-error { background: #ef4444; box-shadow: 0 0 10px #ef4444; opacity: 1 !important;}

/* --- 7. The Stepper Console --- */
#xray-console {
    background: #020617; border: 1px solid #334155; padding: 10px;
    border-radius: 5px; flex-grow: 1; overflow-y: auto;
    display: flex; flex-direction: column; margin-bottom: 15px;
    min-height: 0; /* FIX 2: Forces the text to scroll internally instead of pushing the button down! */
}
.xray-step {
    padding: 10px; margin-bottom: 5px; border-left: 3px solid transparent;
    color: #475569; font-size: 0.85rem; line-height: 1.4;
    transition: all 0.3s ease; border-radius: 0 4px 4px 0;
}
.xray-step.active { border-left-color: #38bdf8; color: #e2e8f0; background: rgba(56, 189, 248, 0.1); }
.xray-step.done { border-left-color: #10b981; color: #94a3b8; }
.xray-step.error { border-left-color: #ef4444; color: #fca5a5; background: rgba(239, 68, 68, 0.1); }

/* --- 8. The Done Button --- */
#btn-xray-done {
    background: #3b82f6; color: white; padding: 12px; border: none;
    border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 1rem;
    display: none; 
    flex-shrink: 0; /* FIX 3: Guarantees the button never gets squished or hidden */
}
#btn-xray-done:hover { background: #2563eb; }